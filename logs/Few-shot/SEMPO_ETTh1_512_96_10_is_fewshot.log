ip: 127.0.0.1, port: 29501, hosts: 1, rank: 0, local_rank: 0, gpus: 1
init_process_group finished
Args in experiment:
>>>>>>>start training : long_term_forecast_SEMPO_CI_ftM_sl512_ll48_pl96_pl64_dm256_nh2_el3_dl3_df128_fc1_ebtimeF_dtTrue_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5019
val 19495
test 19495
loading model
Model parameters:  4070979
	iters: 0, epoch: 1 | loss: 0.5075094 | cost_time: 2 | memory: allocated 240MB, reserved 304MB, cached 304MB 
Epoch: 1 cost time: 4.207154989242554
Epoch: 1, Steps: 43 | Train Loss: 0.4889761 Vali Loss: 0.8698241 Test Loss: 0.5526019
Validation loss decreased (inf --> 0.869824).  Saving model ...
Updating learning rate to 0.0005
	iters: 0, epoch: 2 | loss: 0.4314094 | cost_time: 9 | memory: allocated 261MB, reserved 334MB, cached 334MB 
Epoch: 2 cost time: 2.3797831535339355
Epoch: 2, Steps: 43 | Train Loss: 0.4342298 Vali Loss: 0.8568065 Test Loss: 0.5341851
Validation loss decreased (0.869824 --> 0.856807).  Saving model ...
Updating learning rate to 0.0005
	iters: 0, epoch: 3 | loss: 0.3984298 | cost_time: 9 | memory: allocated 261MB, reserved 334MB, cached 334MB 
Epoch: 3 cost time: 2.7933261394500732
Epoch: 3, Steps: 43 | Train Loss: 0.4063110 Vali Loss: 0.8750579 Test Loss: 0.5313499
EarlyStopping counter: 1 out of 6
Updating learning rate to 0.0005
	iters: 0, epoch: 4 | loss: 0.3827419 | cost_time: 9 | memory: allocated 261MB, reserved 334MB, cached 334MB 
Epoch: 4 cost time: 2.6244852542877197
Epoch: 4, Steps: 43 | Train Loss: 0.3877004 Vali Loss: 0.8923186 Test Loss: 0.5304928
EarlyStopping counter: 2 out of 6
Updating learning rate to 0.0005
	iters: 0, epoch: 5 | loss: 0.3667012 | cost_time: 9 | memory: allocated 261MB, reserved 334MB, cached 334MB 
Epoch: 5 cost time: 2.494786262512207
Epoch: 5, Steps: 43 | Train Loss: 0.3694375 Vali Loss: 0.8853548 Test Loss: 0.5307521
EarlyStopping counter: 3 out of 6
Updating learning rate to 0.00045000000000000004
	iters: 0, epoch: 6 | loss: 0.3525898 | cost_time: 9 | memory: allocated 261MB, reserved 334MB, cached 334MB 
Epoch: 6 cost time: 2.52087664604187
Epoch: 6, Steps: 43 | Train Loss: 0.3551373 Vali Loss: 0.8901699 Test Loss: 0.5371666
EarlyStopping counter: 4 out of 6
Updating learning rate to 0.00040500000000000003
	iters: 0, epoch: 7 | loss: 0.3413970 | cost_time: 8 | memory: allocated 261MB, reserved 334MB, cached 334MB 
Epoch: 7 cost time: 1.9278936386108398
Epoch: 7, Steps: 43 | Train Loss: 0.3459363 Vali Loss: 0.9073801 Test Loss: 0.5413499
EarlyStopping counter: 5 out of 6
Updating learning rate to 0.0003645000000000001
	iters: 0, epoch: 8 | loss: 0.3399744 | cost_time: 8 | memory: allocated 261MB, reserved 334MB, cached 334MB 
Epoch: 8 cost time: 2.5928890705108643
Epoch: 8, Steps: 43 | Train Loss: 0.3362570 Vali Loss: 0.9007473 Test Loss: 0.5351531
EarlyStopping counter: 6 out of 6
Early stopping
>>>>>>>testing : long_term_forecast_SEMPO_CI_ftM_sl512_ll48_pl96_pl64_dm256_nh2_el3_dl3_df128_fc1_ebtimeF_dtTrue_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Model parameters:  6481306
test 19495
test shape: (152, 128, 96, 1) (152, 128, 96, 1)
test shape: (19456, 96, 1) (19456, 96, 1)
mse:0.39016953110694885, mae:0.4144439697265625
